第九天

图像风格迁移；图像分类案例1；图像分类案例2

## 图像风格迁移

使用卷积神经网络自动将某图像中的样式应用在另一图像之上，即样式迁移。

![迁移学习流程](./迁移学习流程.png)

* 预处理函数和后处理函数

预处理函数 preprocess 对输入图像在RGB三个通道分别做标准化，并将结果变换成卷积神经网络接受的输入格式。

后处理函数 postprocess 则将输出图像中的像素值还原回标准化之前的值。

* 利用 VGG 抽取图像特征

VGG网络使用了5个卷积块。实验中，我们选择第四卷积块的最后一个卷积层作为内容层，以及每个卷积块的第一个卷积层作为样式层。

给定输入X，如果简单调用前向计算net(X)，只能获得最后一层的输出。由于我们还需要中间层的输出，因此这里我们逐层计算，并保留内容层和样式层的输出。

因为在训练时无须改变预训练的VGG的模型参数，所以我们可以在训练开始之前就提取出内容图像的内容特征，以及样式图像的样式特征。

* 损失函数

迁移的损失函数由内容损失、样式损失和总变差损失3部分组成。
