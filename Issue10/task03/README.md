第三天

LeNet；卷积神经网络进阶；批量归一化和残差网络

### LeNet

卷积神经网络就是含卷积层的网络。 LeNet交替使用卷积层和最大池化层后接全连接层来进行图像分类。

这块没啥太多新东西。

### 高级的卷积神经网络

#### AlexNet

* LeNet 缺点

LeNet: 在大的真实数据集上的表现并不尽如人意。

1. 神经网络计算复杂。
2. 还没有大量深入研究参数初始化和非凸优化算法等诸多领域。

* 特征提取

机器学习的特征提取: 手工定义的特征提取函数

神经网络的特征提取：通过学习得到数据的多级表征，并逐级表示越来越抽象的概念或模式。

* AlexNet 特点

1. 8 层变换，其中有 5 层卷积和 2 层全连接隐藏层，以及 1 个全连接输出层。
2. 将 `sigmoid` 激活函数改成了更加简单的 `ReLU` 激活函数。
3. 用 `Dropout` 来控制全连接层的模型复杂度。
4. 引入数据增强，如翻转、裁剪和颜色变化，从而进一步扩大数据集来缓解过拟合。

##### VGG

* 卷积核替换

一个 5x5 的卷积核可以用两个 3x3 卷积核代替

两个 3x3 的卷积核的感受野的大小刚好是 5x5，且两个 3x3 的参数量少

* VGG

VGG：通过重复使用简单的基础块来构建深度模型。

Block: 数个相同的填充为1、窗口形状为的 3X3 卷积层,接上一个步幅为2、窗口形状为 2X2 的最大池化层。

注：**卷积层保持输入的高和宽不变，而池化层则对其减半**。

#### NiN

LeNet、AlexNet和VGG：先以由卷积层构成的模块充分抽取 空间特征，再以由全连接层构成的模块来输出分类结果。

NiN：串联多个由卷积层和“全连接”层构成的小网络来构建一个深层网络。

用了输出通道数等于标签类别数的 NiN 块，然后使用全局平均池化层对每个通道中所有元素求平均并直接用于分类。

* 1×1卷积核的作用

1. 放缩通道数：通过控制卷积核的数量达到通道数的放缩。

2. 增加非线性。1×1卷积核的卷积过程相当于全连接层的计算过程，并且还加入了非线性激活函数，从而可以增加网络的非线性。

3. 计算参数少。

* NiN 优势

1. NiN 重复使用由卷积层和代替全连接层的 1×1 卷积层构成的 NiN 块来构建深层网络。

2. NiN 去除了容易造成过拟合的全连接输出层，而是将其替换成输出通道数等于标签类别数的 NiN 块和全局平均池化层。

NiN 的以上设计思想影响了后面一系列卷积神经网络的设计。

#### GoogLeNet

1. 由 Inception 基础块组成。

2. Inception块相当于一个有4条线路的子网络。它通过不同窗口形状的卷积层和最大池化层来并行抽取信息，并使用 1×1 卷积层减少通道数从而降低模型复杂度。

3. 可以自定义的超参数是每个层的输出通道数，我们以此来控制模型复杂度。

PS：**GoogLeNet 参数太多了，需要自己控制一下。**

### 批量归一化和残差网络

#### 批量归一化（BatchNormalization）

利用小批量上的均值和标准差，不断调整神经网络中间输出，从而使整个神经网络在各层的中间输出的数值更稳定。

引入可学习参数：拉伸参数 γ 和偏移参数 β

* 在不同层做批量归一化

1. 对全连接层做批量归一化的位置：**全连接层中的仿射变换和激活函数之间**。
2. 对卷积层做批量归一化的位置：**卷积计算之后、应用激活函数之前**。

计算：**对单通道，batchsize=m,卷积计算输出=pxq 对该通道中m×p×q个元素同时做批量归一化,使用相同的均值和方差**。

* 训练和预测时的批量归一化

训练：**以batch为单位,对每个batch计算均值和方差**。

预测：**用移动平均估算整个训练数据集的样本均值和方差**。

训练批量归一化层时候维护一个移动平滑的样本均值和方差，保存起来在预测时使用。
