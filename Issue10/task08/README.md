第八天

目标检测基础；目标检测进阶；图像分割

## 目标检测基础

### 锚框（anchor box）

假设输入图像高为 h，宽为 w。我们分别以图像的每个像素为中心生成不同形状的锚框。

设大小为 s 且宽高比为 r，那么锚框的宽和高将分别为 ws 乘根号r 和 hs 除以根号r 。当中心位置给定时，已知宽和高的锚框是确定的。

* 交并比（IoU）

可以把边界框内的像素区域看成是像素的集合。如此一来，我们可以用两个边界框的像素集合的Jaccard系数衡量这两个边界框的相似度。

当衡量两个边界框的相似度时，我们通常将Jaccard系数称为交并比（Intersection over Union，IoU），即两个边界框相交面积与相并面积之比。

* NMS

同一图像上，将预测类别非背景的预测边界框按置信度从高到低排序，得到列表 L。

从 L 中选取置信度最高的预测边界框 B1 作为基准，将所有与 B1 的交并比大于某阈值的非基准预测边界框从 L 中移除。

这里的阈值是预先设定的超参数。此时，L 保留了置信度最高的预测边界框并移除了与其相似的其他预测边界框。

接下来，从 L 中选取置信度第二高的预测边界框 B2 作为基准，将所有与 B2 的交并比大于某阈值的非基准预测边界框从 L 中移除。

重复这一过程，直到 L 中所有的预测边界框都曾作为基准。此时 L 中任意一对预测边界框的交并比都小于阈值。最终，输出列表 L 中的所有预测边界框。

* 小结

1. 以每个像素为中心，生成多个大小和宽高比不同的锚框。

2. 交并比是两个边界框相交面积与相并面积之比。

3. 在训练集中，为每个锚框标注两类标签：一是锚框所含目标的类别；二是真实边界框相对锚框的偏移量。

4. 预测时，可以使用非极大值抑制来移除相似的预测边界框，从而令结果简洁。
